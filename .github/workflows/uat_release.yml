name: UAT Release
on:
  workflow_dispatch:

jobs:
  uat_release:
    if: startsWith(github.ref, 'refs/tags/v')
    runs-on: ubuntu-latest
    name: Create Pull Request to UAT

    steps:
      - uses: actions/checkout@v3
      - name: Set Tag
        run: echo "GITHUB_TAG=$(echo ${{ github.ref }} | cut -d '/' -f 3)" >> $GITHUB_ENV
      - name: Create Pull Request
        uses: devops-infra/action-pull-request@v0.5.0
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # source_branch: development
          target_branch: uat
          title: "[UAT] Release ${{ env.GITHUB_TAG }}"
          # template: .github/PULL_REQUEST_TEMPLATE.md
          body: |
            ## Describe your changes

            ## Checklist before requesting a review
            - [ ] Verified that this worked with DEV environment
          label: "UAT"
          get_diff: true
          # reviewer: octocat
          # assignee: octocat
          # ignore_users: "dependabot"
          # allow_no_diff: false
          # - name: Create Pull Request
          #   uses: peter-evans/create-pull-request@v4
          #   with:
          #     delete-branch: true
          #     branch: "uat-${{ env.GITHUB_TAG }}"
          #     base: "uat"
          #     team-reviewers: |
          #       @mysale/cloud-engineering-team
          #     labels: |
          #       UAT
          #     title: "[UAT] Release ${{ env.GITHUB_TAG }}"
          #     body: |
          #       ## Describe your changes

          #       ## Checklist before requesting a review
          #       - [ ] Verified that this worked with DEV environment

